# ğŸ¯ AdMob å»£å‘Šæ•´åˆå®ŒæˆæŒ‡å—

> **å®Œæˆæ—¥æœŸ**: 2025-01-15  
> **æ•´åˆç‹€æ…‹**: âœ… å®Œæˆ  
> **æ¸¬è©¦ç‹€æ…‹**: ä½¿ç”¨æ¸¬è©¦å»£å‘Š ID

---

## ğŸ“Š æ•´åˆæ¦‚æ³

### âœ… å·²å®Œæˆçš„å·¥ä½œ

| é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| AdMob å¥—ä»¶å®‰è£ | âœ… | @capacitor-community/admob |
| å»£å‘Šæœå‹™å‰µå»º | âœ… | src/lib/admob.ts |
| çå‹µå»£å‘Šæ•´åˆ | âœ… | useMissionOperations.tsx |
| åˆå§‹åŒ–é…ç½® | âœ… | main.tsx |
| æ¸¬è©¦ ID é…ç½® | âœ… | ä½¿ç”¨ Google å®˜æ–¹æ¸¬è©¦ ID |

---

## ğŸ® å·²å¯¦ç¾çš„å»£å‘Šé¡å‹

### 1. âœ… **çå‹µå»£å‘Šï¼ˆRewarded Videoï¼‰**

**ç”¨é€”**: è§€çœ‹å»£å‘Šç²å¾—ä»£å¹£  
**ä½ç½®**: ä»»å‹™é é¢  
**çå‹µ**: 5 ä»£å¹£/æ¬¡  
**é™åˆ¶**: æ¯å¤©æœ€å¤š 10 æ¬¡

**æ¸¬è©¦ ID**:
- Android: `ca-app-pub-3940256099942544/5224354917`
- iOS: `ca-app-pub-3940256099942544/1712485313`

---

### 2. ğŸ“¦ **Banner å»£å‘Š**ï¼ˆå·²æ•´åˆï¼‰

**ç”¨é€”**: æŒçºŒæ€§å»£å‘Šå±•ç¤º  
**ä½ç½®**: é¦–é ï¼ˆå·²æ•´åˆï¼‰  
**æ¸¬è©¦ ID**:
- Android: `ca-app-pub-3940256099942544/6300978111`
- iOS: `ca-app-pub-3940256099942544/2934735716`

**å·²æ•´åˆä½ç½®**:
- âœ… é¦–é ï¼ˆHomePageï¼‰

**ä½¿ç”¨çµ„ä»¶**:
```typescript
import { AdBanner } from '@/components/AdBanner';

<AdBanner 
  className="mb-6"
  placeholderText="é¦–é  Banner å»£å‘Š"
/>
```

**æ‰‹å‹•ä½¿ç”¨**:
```typescript
import { AdMobService } from '@/lib/admob';

// é¡¯ç¤º Banner
await AdMobService.showBanner();

// éš±è— Banner
await AdMobService.hideBanner();

// ç§»é™¤ Banner
await AdMobService.removeBanner();
```

---

### 3. ğŸ¬ **æ’é å»£å‘Šï¼ˆInterstitialï¼‰**ï¼ˆå·²æº–å‚™ï¼‰

**å‡½æ•¸**: `AdMobService.prepareInterstitial()` + `showInterstitial()`  
**ç”¨é€”**: ä¸»é¡Œåˆ‡æ›ã€æŠ•ç¥¨å¾Œç­‰å ´æ™¯  
**æ¸¬è©¦ ID**:
- Android: `ca-app-pub-3940256099942544/1033173712`
- iOS: `ca-app-pub-3940256099942544/4411468910`

**ä½¿ç”¨ç¯„ä¾‹**:
```typescript
// æº–å‚™å»£å‘Š
await AdMobService.prepareInterstitial();

// é¡¯ç¤ºå»£å‘Š
await AdMobService.showInterstitial();
```

---

## ğŸ“ å‰µå»ºçš„æª”æ¡ˆ

### 1. **`src/lib/admob.ts`** - AdMob æœå‹™

**åŒ…å«åŠŸèƒ½**:
- âœ… åˆå§‹åŒ– AdMob
- âœ… Banner å»£å‘Šï¼ˆé¡¯ç¤º/éš±è—/ç§»é™¤ï¼‰
- âœ… æ’é å»£å‘Šï¼ˆæº–å‚™/é¡¯ç¤ºï¼‰
- âœ… çå‹µå»£å‘Šï¼ˆæº–å‚™/é¡¯ç¤ºï¼‰
- âœ… å®Œæ•´çš„çå‹µæµç¨‹ï¼ˆ`watchRewardedAd`ï¼‰
- âœ… å¹³å°æª¢æ¸¬ï¼ˆåŸç”Ÿ/Webï¼‰
- âœ… æ¸¬è©¦å»£å‘Š ID ç®¡ç†

**ç¨‹å¼ç¢¼è¡Œæ•¸**: ~300 è¡Œ

### 2. **`src/components/AdBanner.tsx`** - Banner çµ„ä»¶ï¼ˆæ–°å¢ï¼‰

**åŠŸèƒ½**:
- âœ… è‡ªå‹•ç®¡ç† Banner ç”Ÿå‘½é€±æœŸ
- âœ… åŸç”Ÿå¹³å°é¡¯ç¤ºçœŸå¯¦å»£å‘Š
- âœ… Web å¹³å°é¡¯ç¤ºä½”ä½ç¬¦
- âœ… è‡ªå‹•è¼‰å…¥å’Œç§»é™¤
- âœ… å¯è‡ªè¨‚æ¨£å¼

**ä½¿ç”¨ç°¡å–®**:
```tsx
<AdBanner className="mb-6" placeholderText="å»£å‘Š" />
```

---

### 3. **ä¿®æ”¹çš„æª”æ¡ˆ**

#### `package.json`
```json
"@capacitor-community/admob": "^6.0.0"
```

#### `src/hooks/useMissionOperations.tsx`
- æ•´åˆ AdMob çå‹µå»£å‘Š
- è§€çœ‹å»£å‘Š â†’ ç™¼æ”¾çå‹µæµç¨‹
- éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶æç¤º

#### `src/pages/HomePage.tsx`
- æ•´åˆ AdBanner çµ„ä»¶
- é¦–é é¡¯ç¤º Banner å»£å‘Š
- æ›¿æ›åŸæœ‰ä½”ä½ç¬¦

#### `src/main.tsx`
- æ·»åŠ  AdMob åˆå§‹åŒ–
- APP å•Ÿå‹•æ™‚è‡ªå‹•åˆå§‹åŒ–

#### `android-config/AndroidManifest-admob.xml`
- Android AdMob App ID é…ç½®
- ä½¿ç”¨æ¸¬è©¦ ID

---

## ğŸ”§ ä½¿ç”¨æ–¹å¼

### åœ¨ä»»å‹™é é¢è§€çœ‹å»£å‘Š

ç”¨æˆ¶é»æ“Šã€Œè§€çœ‹å»£å‘Šã€æŒ‰éˆ•å¾Œï¼š

1. **é¡¯ç¤º AdMob çå‹µå»£å‘Š**
2. **ç”¨æˆ¶å®Œæ•´è§€çœ‹å»£å‘Š**
3. **AdMob è§¸ç™¼çå‹µå›èª¿**
4. **å‘¼å«å¾Œç«¯ watch-ad Edge Function**
5. **å¾Œç«¯é©—è­‰ä¸¦ç™¼æ”¾ä»£å¹£**
6. **é¡¯ç¤ºæˆåŠŸæç¤º**

**æµç¨‹åœ–**:
```
[ç”¨æˆ¶é»æ“Š] 
  â†’ [AdMobé¡¯ç¤ºå»£å‘Š] 
  â†’ [ç”¨æˆ¶è§€çœ‹å®Œç•¢] 
  â†’ [è§¸ç™¼çå‹µäº‹ä»¶] 
  â†’ [å¾Œç«¯ç™¼æ”¾ä»£å¹£] 
  â†’ [æ›´æ–°ç”¨æˆ¶ä»£å¹£]
  â†’ [é¡¯ç¤ºæˆåŠŸæç¤º]
```

---

### Web å¹³å°è™•ç†

```typescript
// Web å¹³å°è‡ªå‹•æ¨¡æ“¬å»£å‘Šè§€çœ‹
if (!isNativePlatform()) {
  // 1ç§’å¾Œè‡ªå‹•è§¸ç™¼æˆåŠŸå›èª¿
  setTimeout(() => {
    onSuccess();
  }, 1000);
}
```

---

## ğŸš€ éƒ¨ç½²æ­¥é©Ÿ

### 1. å®‰è£ä¾è³´

```bash
npm install
```

### 2. åŒæ­¥ Capacitor

```bash
npx cap sync android
npx cap sync ios
```

### 3. é…ç½® Android

**æª”æ¡ˆ**: `android/app/src/main/AndroidManifest.xml`

åœ¨ `<application>` æ¨™ç±¤å…§æ·»åŠ :

```xml
<!-- AdMob App IDï¼ˆæ¸¬è©¦ç”¨ï¼‰-->
<meta-data
    android:name="com.google.android.gms.ads.APPLICATION_ID"
    android:value="ca-app-pub-3940256099942544~3347511713"/>
```

åƒè€ƒ: `android-config/AndroidManifest-admob.xml`

### 4. é…ç½® iOS

**æª”æ¡ˆ**: `ios/App/App/Info.plist`

åœ¨ `<dict>` æ¨™ç±¤å…§æ·»åŠ :

```xml
<!-- AdMob App IDï¼ˆæ¸¬è©¦ç”¨ï¼‰-->
<key>GADApplicationIdentifier</key>
<string>ca-app-pub-3940256099942544~1458002511</string>

<!-- è¿½è¹¤æ¬Šé™ï¼ˆiOS 14.5+ï¼‰-->
<key>NSUserTrackingUsageDescription</key>
<string>ç‚ºäº†æä¾›å€‹æ€§åŒ–å»£å‘Šé«”é©—ï¼Œæˆ‘å€‘éœ€è¦æ‚¨çš„æˆæ¬Š</string>
```

### 5. å»ºç½® APP

```bash
# Android
npm run build
npx cap sync android
npx cap open android

# iOS
npm run build
npx cap sync ios
npx cap open ios
```

---

## ğŸ§ª æ¸¬è©¦æ–¹å¼

### é–‹ç™¼ç’°å¢ƒæ¸¬è©¦

1. **å•Ÿå‹•æ‡‰ç”¨**
   ```bash
   npm run dev
   ```

2. **åœ¨ç€è¦½å™¨æ¸¬è©¦**ï¼ˆWebï¼‰
   - è§€çœ‹å»£å‘Šæœƒè‡ªå‹•æ¨¡æ“¬æˆåŠŸ
   - 1ç§’å¾Œè§¸ç™¼çå‹µ

3. **åœ¨ Android/iOS æ¸¬è©¦**
   - ä½¿ç”¨ Android Studio / Xcode é‹è¡Œ
   - æœƒé¡¯ç¤ºçœŸå¯¦çš„æ¸¬è©¦å»£å‘Š
   - æ¸¬è©¦å»£å‘Šå¯ä»¥æ­£å¸¸è§€çœ‹ä¸¦ç²å¾—çå‹µ

### æ¸¬è©¦æµç¨‹

1. ç™»å…¥æ‡‰ç”¨
2. é€²å…¥ã€Œä»»å‹™ã€é é¢
3. é»æ“Šã€Œè§€çœ‹å»£å‘Šã€
4. è§€çœ‹å®Œæ•´å»£å‘Š
5. ç¢ºèªç²å¾— 5 ä»£å¹£
6. æª¢æŸ¥å‰©é¤˜æ¬¡æ•¸

---

## âš ï¸ é‡è¦æ³¨æ„äº‹é …

### æ¸¬è©¦ vs æ­£å¼

**ç•¶å‰ç‹€æ…‹**: âœ… ä½¿ç”¨æ¸¬è©¦ ID

**æ¸¬è©¦ ID ç‰¹é»**:
- âœ… ä¸æœƒç”¢ç”ŸçœŸå¯¦æ”¶ç›Š
- âœ… ä¸æœƒé•å AdMob æ”¿ç­–
- âœ… å¯ä»¥ç„¡é™æ¬¡æ¸¬è©¦
- âœ… å»£å‘Šé¡¯ç¤ºæ­£å¸¸

**æ­£å¼ ID**:
- âš ï¸ éœ€è¦åœ¨ Google AdMob ç”³è«‹
- âš ï¸ è‡ªå·±é»æ“Šæœƒè¢«å°è™Ÿ
- âš ï¸ éœ€è¦çœŸå¯¦ç”¨æˆ¶æµé‡
- âš ï¸ å¯©æ ¸é€šéå¾Œæ‰èƒ½ä½¿ç”¨

---

### åˆ‡æ›åˆ°æ­£å¼ ID

ç•¶æº–å‚™ä¸Šç·šæ™‚ï¼Œéœ€è¦:

1. **ç”³è«‹ AdMob å¸³è™Ÿ**
   - https://admob.google.com/

2. **å‰µå»º App**
   - ç²å¾— App ID

3. **å‰µå»ºå»£å‘Šå–®å…ƒ**
   - Banner å»£å‘Šå–®å…ƒ
   - Interstitial å»£å‘Šå–®å…ƒ
   - Rewarded å»£å‘Šå–®å…ƒ

4. **æ›´æ–°ä»£ç¢¼**

**æª”æ¡ˆ**: `src/lib/admob.ts`

```typescript
// å°‡æ¸¬è©¦ ID æ›¿æ›ç‚ºæ­£å¼ ID
export const PROD_AD_IDS = {
  android: {
    banner: 'ca-app-pub-XXXXXXXX/YYYYYY',
    interstitial: 'ca-app-pub-XXXXXXXX/ZZZZZZ',
    rewarded: 'ca-app-pub-XXXXXXXX/WWWWWW',
  },
  ios: {
    banner: 'ca-app-pub-XXXXXXXX/YYYYYY',
    interstitial: 'ca-app-pub-XXXXXXXX/ZZZZZZ',
    rewarded: 'ca-app-pub-XXXXXXXX/WWWWWW',
  }
};
```

5. **æ›´æ–° AndroidManifest.xml å’Œ Info.plist**

å°‡æ¸¬è©¦ App ID æ›¿æ›ç‚ºæ­£å¼ App ID

---

## ğŸ“Š AdMob æ”¶ç›Šä¼°ç®—

### çå‹µå»£å‘Š eCPMï¼ˆåƒæ¬¡å±•ç¤ºæ”¶ç›Šï¼‰

- **ä¸€èˆ¬ç¯„åœ**: $1 - $10 USD
- **å¹³å‡å€¼**: ~$3 USD
- **å°ç£å¸‚å ´**: ~$2 - $5 USD

### é ä¼°æ”¶ç›Š

å‡è¨­ï¼š
- æ¯æ—¥æ´»èºç”¨æˆ¶: 100 äºº
- æ¯äººæ¯å¤©è§€çœ‹: 3 æ¬¡å»£å‘Š
- eCPM: $3 USD

**è¨ˆç®—**:
```
æ¯æ—¥å±•ç¤º: 100 Ã— 3 = 300 æ¬¡
æ¯æ—¥æ”¶ç›Š: (300 / 1000) Ã— $3 = $0.9 USD
æ¯æœˆæ”¶ç›Š: $0.9 Ã— 30 = $27 USD
```

**ç•¶ç”¨æˆ¶å¢é•·åˆ° 1000 äºº**:
- æ¯æ—¥æ”¶ç›Š: ~$9 USD
- æ¯æœˆæ”¶ç›Š: ~$270 USD

---

## ğŸ¯ å„ªåŒ–å»ºè­°

### 1. å¢åŠ å»£å‘Šå±•ç¤ºæ©Ÿæœƒ

- âœ… è§€çœ‹å»£å‘Šç²å¾—ä»£å¹£ï¼ˆå·²å¯¦ç¾ï¼‰
- â³ ä¸»é¡Œåˆ‡æ›æ™‚é¡¯ç¤ºæ’é å»£å‘Š
- â³ æŠ•ç¥¨å¾Œé¡¯ç¤ºæ’é å»£å‘Š
- â³ é¦–é é¡¯ç¤º Banner å»£å‘Š

### 2. æå‡è§€çœ‹ç‡

- å¢åŠ çå‹µå¸å¼•åŠ›
- é™æ™‚é›™å€çå‹µæ´»å‹•
- æˆå°±ç³»çµ±æ•´åˆ
- æ¯æ—¥ä»»å‹™æ•´åˆ

### 3. A/B æ¸¬è©¦

- æ¸¬è©¦ä¸åŒçå‹µé‡‘é¡
- æ¸¬è©¦å»£å‘Šå±•ç¤ºé »ç‡
- æ¸¬è©¦å»£å‘Šä½ç½®

---

## ğŸ› å¸¸è¦‹å•é¡Œ

### Q1: å»£å‘Šä¸é¡¯ç¤ºï¼Ÿ

**æª¢æŸ¥**:
1. æ˜¯å¦åœ¨åŸç”Ÿå¹³å°ï¼ˆAndroid/iOSï¼‰
2. ç¶²è·¯é€£æ¥æ˜¯å¦æ­£å¸¸
3. AdMob æ˜¯å¦åˆå§‹åŒ–æˆåŠŸ
4. æŸ¥çœ‹ Console éŒ¯èª¤è¨Šæ¯

### Q2: Web å¹³å°æ¸¬è©¦ï¼Ÿ

**ç­”**: Web å¹³å°æœƒè‡ªå‹•æ¨¡æ“¬å»£å‘Šè§€çœ‹ï¼Œ1ç§’å¾Œè§¸ç™¼æˆåŠŸå›èª¿ã€‚

### Q3: æ¸¬è©¦å»£å‘Šç„¡æ³•é—œé–‰ï¼Ÿ

**ç­”**: æ¸¬è©¦å»£å‘Šé€šå¸¸æœ‰ã€ŒXã€æŒ‰éˆ•ï¼Œç­‰å¾…å¹¾ç§’å¾Œå‡ºç¾ã€‚

### Q4: åˆ‡æ›åˆ°æ­£å¼ ID å¾Œç„¡å»£å‘Šï¼Ÿ

**æª¢æŸ¥**:
1. App ID æ˜¯å¦æ­£ç¢º
2. å»£å‘Šå–®å…ƒ ID æ˜¯å¦æ­£ç¢º
3. AdMob å¸³è™Ÿæ˜¯å¦å¯©æ ¸é€šé
4. æ˜¯å¦æœ‰è¶³å¤ çš„å»£å‘Šåº«å­˜

---

## ğŸ“ ç¨‹å¼ç¢¼ç¯„ä¾‹

### åœ¨ä»»ä½•çµ„ä»¶ä¸­ä½¿ç”¨å»£å‘Š

```typescript
import { AdMobService } from '@/lib/admob';
import { toast } from 'sonner';

// è§€çœ‹çå‹µå»£å‘Š
const handleWatchAd = async () => {
  try {
    await AdMobService.watchRewardedAd(
      // æˆåŠŸå›èª¿
      () => {
        toast.success('ç²å¾—çå‹µï¼');
        // åŸ·è¡Œçå‹µé‚è¼¯
      },
      // éŒ¯èª¤å›èª¿
      (error) => {
        toast.error('å»£å‘Šè¼‰å…¥å¤±æ•—');
      }
    );
  } catch (error) {
    console.error('Ad error:', error);
  }
};

// é¡¯ç¤º Banner
const showBanner = async () => {
  const success = await AdMobService.showBanner();
  if (success) {
    console.log('Banner shown');
  }
};

// é¡¯ç¤ºæ’é å»£å‘Š
const showInterstitial = async () => {
  await AdMobService.prepareInterstitial();
  await new Promise(r => setTimeout(r, 1000)); // ç­‰å¾…æº–å‚™
  await AdMobService.showInterstitial();
};
```

---

## ğŸ“‹ æª¢æŸ¥æ¸…å–®

### é–‹ç™¼ç’°å¢ƒ

- [x] å®‰è£ AdMob å¥—ä»¶
- [x] å‰µå»º AdMob æœå‹™
- [x] æ•´åˆçå‹µå»£å‘Š
- [x] ä½¿ç”¨æ¸¬è©¦ ID
- [x] åˆå§‹åŒ–é…ç½®
- [ ] æ¸¬è©¦ Android å¯¦æ©Ÿ
- [ ] æ¸¬è©¦ iOS å¯¦æ©Ÿ

### ä¸Šç·šå‰

- [ ] ç”³è«‹ AdMob å¸³è™Ÿ
- [ ] å‰µå»ºæ­£å¼ App
- [ ] å‰µå»ºå»£å‘Šå–®å…ƒ
- [ ] æ›¿æ›æ¸¬è©¦ ID
- [ ] æ›´æ–° AndroidManifest
- [ ] æ›´æ–° Info.plist
- [ ] éš±ç§æ”¿ç­–æ·»åŠ å»£å‘Šèªªæ˜
- [ ] å¯©æ ¸é€šé

---

## ğŸŠ ç¸½çµ

**AdMob å»£å‘Šæ•´åˆå·²å®Œæˆï¼** âœ…

### ç•¶å‰ç‹€æ…‹:
- âœ… ä½¿ç”¨æ¸¬è©¦å»£å‘Š ID
- âœ… çå‹µå»£å‘Šå¯ç”¨
- âœ… è§€çœ‹å»£å‘Šç²å¾—ä»£å¹£
- âœ… Web å¹³å°å…¼å®¹
- âœ… éŒ¯èª¤è™•ç†å®Œå–„

### ä¸‹ä¸€æ­¥:
1. æ¸¬è©¦å¯¦æ©Ÿé‹è¡Œ
2. ç”³è«‹ AdMob å¸³è™Ÿ
3. ç²å–æ­£å¼å»£å‘Š ID
4. ä¸Šç·šå‰æ›¿æ›æ¸¬è©¦ ID

### é ä¼°æ™‚é–“:
- AdMob ç”³è«‹: 1-2 å¤©
- å¯©æ ¸é€šé: 1-7 å¤©
- ä¸Šç·šä½¿ç”¨: ç«‹å³

---

**éœ€è¦å”åŠ©ï¼Ÿ**
- AdMob æ–‡æª”: https://developers.google.com/admob
- Capacitor AdMob: https://github.com/capacitor-community/admob

**æ­å–œï¼æ‚¨çš„æ‡‰ç”¨ç¾åœ¨å¯ä»¥é€éå»£å‘Šç²åˆ©äº†ï¼** ğŸ‰ğŸ’°

