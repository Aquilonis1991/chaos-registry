# ✅ 選項重複檢查功能

## 🎯 功能說明

在建立主題時，系統會自動檢查投票選項是否重複，確保每個選項都是唯一的。

---

## 🔧 實現方式

### 1. **即時視覺提示**

當用戶輸入選項時，系統會即時檢查：
- ✅ **正常選項**：顯示正常邊框
- ❌ **重複選項**：
  - 顯示紅色邊框
  - 下方顯示提示訊息：「此選項與其他選項重複」

### 2. **提交時驗證**

當用戶點擊「建立主題」時：
- 系統會檢查所有選項（忽略前後空格）
- 如果發現重複，顯示錯誤訊息：
  ```
  ❌ 選項不可重複！
  請確保每個選項都是唯一的
  ```
- 阻止提交，讓用戶修改

---

## 🧪 測試案例

### 測試 1：相同文字
**輸入**：
- 選項 1：`蘋果`
- 選項 2：`蘋果`

**結果**：
- ❌ 選項 2 顯示紅色邊框
- ❌ 無法提交

---

### 測試 2：前後空格
**輸入**：
- 選項 1：`蘋果`
- 選項 2：` 蘋果 ` （前後有空格）

**結果**：
- ❌ 選項 2 顯示紅色邊框（系統會 trim 空格）
- ❌ 無法提交

---

### 測試 3：大小寫敏感
**輸入**：
- 選項 1：`Apple`
- 選項 2：`apple`

**結果**：
- ✅ 允許（大小寫不同視為不同選項）
- ✅ 可以提交

**註**：JavaScript 的字串比較是大小寫敏感的

---

### 測試 4：多個重複
**輸入**：
- 選項 1：`A`
- 選項 2：`B`
- 選項 3：`A`
- 選項 4：`B`

**結果**：
- ❌ 選項 3 顯示紅色邊框（與選項 1 重複）
- ❌ 選項 4 顯示紅色邊框（與選項 2 重複）
- ❌ 無法提交

---

### 測試 5：空選項
**輸入**：
- 選項 1：`A`
- 選項 2：``（空）
- 選項 3：``（空）

**結果**：
- ✅ 空選項不會被視為重複
- ⚠️ 但會被 Zod 驗證阻擋（選項不可為空）

---

## 📋 檢查邏輯

```typescript
// 1. 過濾並清理選項
const trimmedOptions = options
  .map(opt => opt.trim())        // 移除前後空格
  .filter(opt => opt !== '');     // 過濾空選項

// 2. 使用 Set 檢查唯一性
const uniqueOptions = new Set(trimmedOptions);

// 3. 如果數量不同，表示有重複
if (trimmedOptions.length !== uniqueOptions.size) {
  // 顯示錯誤
}
```

---

## 🎨 用戶體驗

### 即時反饋
用戶在輸入時立即看到重複警告：
- 🔴 紅色邊框 - 視覺上明顯
- 📝 提示文字 - 說明問題
- ⚡ 即時更新 - 修改後立即消失

### 提交驗證
用戶點擊提交時：
- 🛑 阻止提交
- 💬 明確的錯誤訊息
- 🎯 指引用戶修正

---

## ✅ 優點

1. **防止錯誤**：確保選項唯一性
2. **即時反饋**：輸入時就能看到問題
3. **用戶友善**：清楚的視覺提示
4. **智能處理**：自動處理空格

---

## 🧪 如何測試

### 步驟 1：進入建立主題頁面
1. 打開 http://localhost:8080/create
2. 填寫基本資訊

### 步驟 2：測試重複選項
1. 選項 1 輸入：`選項A`
2. 選項 2 輸入：`選項A`
3. **應該看到**：
   - 選項 2 顯示紅色邊框
   - 下方顯示「此選項與其他選項重複」

### 步驟 3：測試提交阻擋
1. 點擊「建立主題」
2. **應該看到**：
   - Toast 錯誤訊息
   - 「選項不可重複！」
   - 無法提交

### 步驟 4：測試修正
1. 將選項 2 改為：`選項B`
2. **應該看到**：
   - 紅色邊框消失
   - 提示文字消失
3. 點擊「建立主題」
4. **應該**：成功建立

---

## 🎯 成功標誌

- ✅ 重複選項顯示紅色邊框
- ✅ 顯示清楚的提示訊息
- ✅ 無法提交重複選項的主題
- ✅ 修正後可以正常提交
- ✅ 空格被正確處理

---

**現在就可以測試了！** 🚀


